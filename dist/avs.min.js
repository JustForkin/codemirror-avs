/*! codemirror-avs-mode | MIT License | github.com/visbot/codemirror-avs-mode */
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("codemirror")):"function"==typeof define&&define.amd?define(["codemirror"],e):e(CodeMirror)}(function(O){"use strict";function L(e,t,n,i,r,o){this.indented=e,this.column=t,this.type=n,this.info=i,this.align=r,this.prev=o}function T(e,t,n,i){var r=e.indented;return e.context&&"statement"==e.context.type&&"statement"!=n&&(r=e.context.indented),e.context=new L(r,t,n,i,null,e.context)}function q(e){var t=e.context.type;return")"!=t&&"]"!=t&&"}"!=t||(e.indented=e.context.indented),e.context=e.context.prev}function A(e,t,n){return"variable"==t.prevToken||"type"==t.prevToken||(!!/\S(?:[^- ]>|[*\]])\s*$|\*$/.test(e.string.slice(0,n))||(!(!t.typeAtEndOfLine||e.column()!=e.indentation())||void 0))}function P(e){for(;;){if(!e||"top"==e.type)return!0;if("}"==e.type&&"namespace"!=e.prev.info)return!1;e=e.prev}}function e(e){for(var t={},n=e.split(" "),i=0;i<n.length;++i)t[n[i]]=!0;return t}function M(e,t){return"function"==typeof e?e(t):e.propertyIsEnumerable(t)}O.defineMode("avs",function(e,s){var a,f,u=e.indentUnit,l=s.statementIndentUnit||u,d=s.dontAlignCalls,c=s.keywords||{},p=s.builtin||{},m=s.blockKeywords||{},v=s.defKeywords||{},y=s.types||{},b=s.constants||{},k=s.hooks||{},h=s.multiLineStrings,o=!1!==s.indentStatements,g=(s.indentSwitch,s.namespaceSeparator),x=s.isPunctuationChar||/[\[\]{}\(\),;\:\.]/,w=s.numberStart||/[\d\.]/,S=s.number||/^(?:0x[a-f\d]+|0b[01]+|(?:\d+\.?\d*|\.\d+)(?:e[-+]?\d+)?)(u|ll?|l|f)?/i,z=s.isOperatorChar||/[+\-*&%=<>!?|\/]/,C=s.isIdentifierChar||/[\w\$_\xa1-\uffff]/;function $(e,t){var o,n=e.next();if(k[n]){var i=k[n](e,t);if(!1!==i)return i}if('"'==n||"'"==n)return t.tokenize=(o=n,function(e,t){for(var n,i=!1,r=!1;null!=(n=e.next());){if(n==o&&!i){r=!0;break}i=!i&&"\\"==n}return(r||!i&&!h)&&(t.tokenize=null),"string"}),t.tokenize(e,t);if(x.test(n))return a=n,null;if(w.test(n)){if(e.backUp(1),e.match(S))return"number";e.next()}if("/"==n){if(e.eat("*"))return(t.tokenize=E)(e,t);if(e.eat("/"))return e.skipToEnd(),"comment"}if(z.test(n)){for(;!e.match(/^\/[\/*]/,!1)&&e.eat(z););return"operator"}if(e.eatWhile(C),g)for(;e.match(g);)e.eatWhile(C);var r=e.current();return M(c,r)?(M(m,r)&&(a="newstatement"),M(v,r)&&(f=!0),"keyword"):M(y,r)?"type":M(p,r)?(M(m,r)&&(a="newstatement"),"builtin"):M(b,r)?"variable-2":"variable"}function E(e,t){for(var n,i=!1;n=e.next();){if("/"==n&&i){t.tokenize=null;break}i="*"==n}return"comment"}function I(e,t){s.typeFirstDefinitions&&e.eol()&&P(t.context)&&(t.typeAtEndOfLine=A(e,t,e.pos))}return{startState:function(e){return{tokenize:null,context:new L((e||0)-u,0,"top",null,!1),indented:0,startOfLine:!0,prevToken:null}},token:function(e,t){var n=t.context;if(e.sol()&&(null==n.align&&(n.align=!1),t.indented=e.indentation(),t.startOfLine=!0),e.eatSpace())return I(e,t),null;a=f=null;var i=(t.tokenize||$)(e,t);if("comment"==i||"meta"==i)return i;if(null==n.align&&(n.align=!0),";"==a||":"==a||","==a&&e.match(/^\s*(?:\/\/.*)?$/,!1))for(;"statement"==t.context.type;)q(t);else if("{"==a)T(t,e.column(),"}");else if("["==a)T(t,e.column(),"]");else if("("==a)T(t,e.column(),")");else if("}"==a){for(;"statement"==n.type;)n=q(t);for("}"==n.type&&(n=q(t));"statement"==n.type;)n=q(t)}else a==n.type?q(t):o&&(("}"==n.type||"top"==n.type)&&";"!=a||"statement"==n.type&&"newstatement"==a)&&T(t,e.column(),"statement",e.current());if("variable"==i&&("def"==t.prevToken||s.typeFirstDefinitions&&A(e,t,e.start)&&P(t.context)&&e.match(/^\s*\(/,!1))&&(i="def"),k.token){var r=k.token(e,t,i);void 0!==r&&(i=r)}return"def"==i&&!1===s.styleDefs&&(i="variable"),t.startOfLine=!1,t.prevToken=f?"def":i||a,I(e,t),i},indent:function(e,t){if(e.tokenize!=$&&null!=e.tokenize||e.typeAtEndOfLine)return O.Pass;var n=e.context,i=t&&t.charAt(0);if("statement"==n.type&&"}"==i&&(n=n.prev),s.dontIndentStatements)for(;"statement"==n.type&&s.dontIndentStatements.test(n.info);)n=n.prev;if(k.indent){var r=k.indent(e,n,t);if("number"==typeof r)return r}var o=i==n.type,a=n.prev&&"switch"==n.prev.info;if(s.allmanIndentation&&/[{(]/.test(i)){for(;"top"!=n.type&&"}"!=n.type;)n=n.prev;return n.indented}return"statement"==n.type?n.indented+("{"==i?0:l):!n.align||d&&")"==n.type?")"!=n.type||o?n.indented+(o?0:u)+(o||!a||/^(?:case|default)\b/.test(t)?0:u):n.indented+l:n.column+(o?0:1)},blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:"//"}}),function(e,t){"string"==typeof e&&(e=[e]);var n=[];function i(e){if(e)for(var t in e)e.hasOwnProperty(t)&&n.push(t)}i(t.keywords),i(t.builtin),i(t.constants),n.length&&(t.helperType=e[0],O.registerHelper("hintWords",e[0],n));for(var r=0;r<e.length;++r)O.defineMIME(e[r],t)}(["text/x-avs","avs"],{name:"avs",keywords:e("n x y i v b red green blue linesize skip drawmode w h d t"),builtin:e("abs sin cos tan asin acos atan atan2 sqr sqrt invsqrt pow exp log log10 floor ceil sign min max sigmoid rand band bor bnot if assign exec2 equal above below getosc getspec gettime getkbmouse megabuf gmegabuf loop"),constants:e("$e $ph $pi $E $PH $PI"),indentSwitch:!1})});