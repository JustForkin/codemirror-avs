/*! codemirror-avs | MIT License | github.com/visbot/codemirror-avs */
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("codemirror")):"function"==typeof define&&define.amd?define(["codemirror"],e):e(CodeMirror)}(function(L){"use strict";function T(e,t,n,i,r,o){this.indented=e,this.column=t,this.type=n,this.info=i,this.align=r,this.prev=o}function q(e,t,n,i){var r=e.indented;return e.context&&"statement"==e.context.type&&"statement"!=n&&(r=e.context.indented),e.context=new T(r,t,n,i,null,e.context)}function A(e){var t=e.context.type;return")"!=t&&"]"!=t&&"}"!=t||(e.indented=e.context.indented),e.context=e.context.prev}function P(e,t,n){return"variable"==t.prevToken||"type"==t.prevToken||(!!/\S(?:[^- ]>|[*\]])\s*$|\*$/.test(e.string.slice(0,n))||(!(!t.typeAtEndOfLine||e.column()!=e.indentation())||void 0))}function M(e){for(;;){if(!e||"top"==e.type)return!0;if("}"==e.type&&"namespace"!=e.prev.info)return!1;e=e.prev}}function e(e){for(var t={},n=e.split(" "),i=0;i<n.length;++i)t[n[i]]=!0;return t}function D(e,t){return"function"==typeof e?e(t):e.propertyIsEnumerable(t)}L.defineMode("avs",function(e,s){var a,f,l=e.indentUnit,u=s.statementIndentUnit||l,c=s.dontAlignCalls,d=s.keywords||{},p=s.builtin||{},m=s.blockKeywords||{},v=s.defKeywords||{},y=s.types||{},b=s.constants||{},k=s.variables||{},h=s.hooks||{},g=s.multiLineStrings,o=!1!==s.indentStatements,x=(s.indentSwitch,s.namespaceSeparator),w=s.isPunctuationChar||/[\[\]{}\(\),;\:\.]/,S=s.numberStart||/[\d\.]/,z=s.number||/^(?:0x[a-f\d]+|0b[01]+|(?:\d+\.?\d*|\.\d+)(?:e[-+]?\d+)?)(u|ll?|l|f)?/i,C=s.isOperatorChar||/[+\-*&%=<>!?|\/]/,$=s.isIdentifierChar||/[\w\$_\xa1-\uffff]/;function E(e,t){var o,n=e.next();if(h[n]){var i=h[n](e,t);if(!1!==i)return i}if('"'==n||"'"==n)return t.tokenize=(o=n,function(e,t){for(var n,i=!1,r=!1;null!=(n=e.next());){if(n==o&&!i){r=!0;break}i=!i&&"\\"==n}return(r||!i&&!g)&&(t.tokenize=null),"string"}),t.tokenize(e,t);if(w.test(n))return a=n,null;if(S.test(n)){if(e.backUp(1),e.match(z))return"number";e.next()}if("/"==n){if(e.eat("*"))return(t.tokenize=I)(e,t);if(e.eat("/"))return e.skipToEnd(),"comment"}if(C.test(n)){for(;!e.match(/^\/[\/*]/,!1)&&e.eat(C););return"operator"}if(e.eatWhile($),x)for(;e.match(x);)e.eatWhile($);var r=e.current();return D(d,r)?(D(m,r)&&(a="newstatement"),D(v,r)&&(f=!0),"keyword"):D(y,r)?"type":D(p,r)?(D(m,r)&&(a="newstatement"),"builtin"):D(k,r)?"variable":D(b,r)?"variable-2":"keyword"}function I(e,t){for(var n,i=!1;n=e.next();){if("/"==n&&i){t.tokenize=null;break}i="*"==n}return"comment"}function O(e,t){s.typeFirstDefinitions&&e.eol()&&M(t.context)&&(t.typeAtEndOfLine=P(e,t,e.pos))}return{startState:function(e){return{tokenize:null,context:new T((e||0)-l,0,"top",null,!1),indented:0,startOfLine:!0,prevToken:null}},token:function(e,t){var n=t.context;if(e.sol()&&(null==n.align&&(n.align=!1),t.indented=e.indentation(),t.startOfLine=!0),e.eatSpace())return O(e,t),null;a=f=null;var i=(t.tokenize||E)(e,t);if("comment"==i||"meta"==i)return i;if(null==n.align&&(n.align=!0),";"==a||":"==a||","==a&&e.match(/^\s*(?:\/\/.*)?$/,!1))for(;"statement"==t.context.type;)A(t);else if("{"==a)q(t,e.column(),"}");else if("["==a)q(t,e.column(),"]");else if("("==a)q(t,e.column(),")");else if("}"==a){for(;"statement"==n.type;)n=A(t);for("}"==n.type&&(n=A(t));"statement"==n.type;)n=A(t)}else a==n.type?A(t):o&&(("}"==n.type||"top"==n.type)&&";"!=a||"statement"==n.type&&"newstatement"==a)&&q(t,e.column(),"statement",e.current());if("variable"==i&&("def"==t.prevToken||s.typeFirstDefinitions&&P(e,t,e.start)&&M(t.context)&&e.match(/^\s*\(/,!1))&&(i="def"),h.token){var r=h.token(e,t,i);void 0!==r&&(i=r)}return"def"==i&&!1===s.styleDefs&&(i="variable"),t.startOfLine=!1,t.prevToken=f?"def":i||a,O(e,t),i},indent:function(e,t){if(e.tokenize!=E&&null!=e.tokenize||e.typeAtEndOfLine)return L.Pass;var n=e.context,i=t&&t.charAt(0);if("statement"==n.type&&"}"==i&&(n=n.prev),s.dontIndentStatements)for(;"statement"==n.type&&s.dontIndentStatements.test(n.info);)n=n.prev;if(h.indent){var r=h.indent(e,n,t);if("number"==typeof r)return r}var o=i==n.type,a=n.prev&&"switch"==n.prev.info;if(s.allmanIndentation&&/[{(]/.test(i)){for(;"top"!=n.type&&"}"!=n.type;)n=n.prev;return n.indented}return"statement"==n.type?n.indented+("{"==i?0:u):!n.align||c&&")"==n.type?")"!=n.type||o?n.indented+(o?0:l)+(o||!a||/^(?:case|default)\b/.test(t)?0:l):n.indented+u:n.column+(o?0:1)},blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:"//"}}),function(e,t){"string"==typeof e&&(e=[e]);var n=[];function i(e){if(e)for(var t in e)e.hasOwnProperty(t)&&n.push(t)}i(t.variables),i(t.builtin),i(t.constants),n.length&&(t.helperType=e[0],L.registerHelper("hintWords",e[0],n));for(var r=0;r<e.length;++r)L.defineMIME(e[r],t)}(["text/x-avs","avs"],{name:"avs",variables:e("n x y z i v b red green blue linesize skip drawmode w h d t"),builtin:e("abs sin cos tan asin acos atan atan2 sqr sqrt invsqrt pow exp log log10 floor ceil sign min max sigmoid rand band bor bnot if assign exec2 equal above below getosc getspec gettime getkbmouse megabuf gmegabuf loop"),constants:e("$e $ph $pi $E $PH $PI"),indentSwitch:!1})});